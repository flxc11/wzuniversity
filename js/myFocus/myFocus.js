var $id=function(a){return"string"==typeof a?document.getElementById(a):a},$tag=function(a,b){return($id(b)||document).getElementsByTagName(a)},$tag_=function(a,b){return $getChild(a,b,"tag")},$class=function(a,b){var e,f,c=$tag("*",b),d=[];for(e=0,f=c.length;f>e;e++)hasClass(a,c[e])&&d.push(c[e]);return d},$class_=function(a,b){return $getChild(a,b)},$getChild=function(a,b,c){var h,d=[],e="tag"===c?$tag:$class,f=e(a,b),g=f.length;for(h=0;g>h;h++)f[h].parentNode===b&&d.push(f[h]),h+=e(a,f[h]).length;return d},hasClass=function(className,node){return eval("/(^|\\s)"+className+"(\\s|$)/").test(node.className)};window.myFocus=function(a){return new myFocus.constr(a)},myFocus.extend=function(){var c,a=arguments,b=a.length;for(this===myFocus?1===b?(dest=myFocus,i=0):(dest=a[0],i=1):(dest=this,i=0),i;b>i;i++)for(c in a[i])dest[c]=a[i][c];return dest},myFocus.extend({defConfig:{pattern:"mF_fancy",trigger:"click",txtHeight:"default",wrap:!0,auto:!0,time:4,index:0,loadingShow:!0,delay:100,autoZoom:!1,onChange:null,xmlFile:"",__focusConstr__:!0},constr:function(a){var d,b=a,c=b&&b.length;if(b instanceof myFocus.constr)return b;if(this.length=0,!b||b.sort&&!c||b.item&&!c)Array.prototype.push.call(this);else if(b.__focusConstr__)b=$id(b.id),Array.prototype.push.call(this,b),this.settings=a,this.HTMLUList=$tag("li",$tag("ul",b)[0]),this.HTMLUListLength=this.HTMLUList.length;else if(c)for(d=0;c>d;d++)Array.prototype.push.call(this,b[d]);else Array.prototype.push.call(this,b);return this},fn:{splice:[].splice},pattern:{},config:{}}),myFocus.constr.prototype=myFocus.fn,myFocus.fn.extend=myFocus.pattern.extend=myFocus.config.extend=myFocus.extend,myFocus.fn.extend({find:function(a){var f,g,h,i,j,k,l,m,n,o,b=this,c=!1,d=myFocus,e=this.parseSelector(a);if(this.length)for(f=0,g=e.length;g>f;f++){switch(h=[],i=e[f],i.charAt(0)){case">":c=!0;break;case".":j=i.slice(1),k=c?$class_:$class,d(b).each(function(){h=h.concat(k(j,this))}),c=!1;break;case"#":l=i.slice(1),m=$id(l),m&&h.push($id(l)),c=!1;break;default:k=c?$tag_:$tag,n=i.split("."),o=n[0],j=n[1],d(b).each(function(){var b,c,a=k(o,this);for(b=0,c=a.length;c>b;b++)(!j||hasClass(j,a[b]))&&h.push(a[b])}),c=!1}c||(b=h)}return d(b)},parent:function(){return myFocus(this[0].parentNode)},html:function(a){return"undefined"!=typeof a?(this[0].innerHTML=a,this):this[0].innerHTML},each:function(a){var c,d,e,b=this;for(c=0,d=b.length;d>c&&(e=a.call(b[c],c),e!==!1);c++);return this},eq:function(a){return myFocus(this[a])},parseSelector:function(a){for(var d,b=/(([^[\]'"]+)+\]|\\.|([^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?/g,c=[];null!==(d=b.exec(a));)c.push(d[1]);return c},wrap:function(a){var d,b=this[0],c=document.createElement("div");return c.innerHTML=a,d=c.firstChild,b.parentNode.replaceChild(d,b),d.appendChild(b),this},addHtml:function(a){var d,b=this[0],c=document.createElement("div");return c.innerHTML=a,d=c.childNodes[0],b.appendChild(d),myFocus(d)},addList:function(a,b){var f,h,g,c=this.HTMLUList,d=this.HTMLUListLength,e=['<div class="'+a+'"><ul>'];for(f=0;d>f;f++){switch(g=$tag("img",c[f])[0],b){case"num":h="<a>"+(f+1)+"</a><b></b>";break;case"txt":h=g?c[f].innerHTML.replace(/\<img(.|\n|\r)*?\>/i,g.alt)+"<p>"+g.getAttribute("text")+"</p><b></b>":"";break;case"thumb":h=g?"<a><img src="+(g.getAttribute("thumb")||g.src)+" /></a><b></b>":"";break;default:h="<a></a><b></b>"}e.push("<li>"+h+"</li>")}return e.push("</ul></div>"),this.addHtml(e.join(""))},addListNum:function(a){return this.addList(a||"num","num")},addListTxt:function(a){return this.addList(a||"txt","txt")},addListThumb:function(a){return this.addList(a||"thumb","thumb")},remove:function(){var a=this[0];a&&a.parentNode.removeChild(a)},repeat:function(a){var b,c,d,e;for(a=a||2,b=this[0].parentNode,c=b.innerHTML,d=[],e=0;a>e;e++)d.push(c);return b.innerHTML=d.join(""),myFocus(b).find(this[0].nodeName)}}),myFocus.fn.extend({css:function(a){var c,f,g,b=this[0],d=[";"],e=myFocus.isIE;if(!b)return this;if("string"==typeof a)return"float"===a&&(a=e?"styleFloat":"cssFloat"),(c=b.style[a])||(c=(e?b.currentStyle:getComputedStyle(b,""))[a]),"opacity"===a&&void 0===c&&(c=1),"auto"!==c||"width"!==a&&"height"!==a||(c=b["offset"+a.replace(/\w/i,function(a){return a.toUpperCase()})]),f=parseFloat(c),isNaN(f)?c:f;for(g in a)"number"!=typeof a[g]||this.cssNumber[g]||(a[g]+="px"),d.push(g.replace(/([A-Z])/g,"-$1")+":"+a[g]+";"),"opacity"===g&&d.push("filter:alpha(opacity="+100*a[g]+")");return b.style.cssText+=d.join(""),this},setOpacity:function(a){this[0].style.opacity=a,this[0].style.filter="alpha(opacity="+100*a+")"},setAnimateStyle:function(a,b,c){this[0].style[b]=Math[c](a)+"px"},addClass:function(a){return this[0].className+=" "+a,this},removeClass:function(className){var o=this[0],cls=className&&o.className,reg="/\\s*\\b"+className+"\\b/g";return o.className=cls?cls.replace(eval(reg),""):"",this},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0}}),myFocus.fn.extend({animate:function(a,b,c,d,e,f){var k,l,m,n,o,p,q,r,s,g=this,h=g[0],i="opacity"===a,j=!1;return e&&e.call(h),"string"==typeof b&&(/^[+-]=\d+/.test(b)&&(b=b.replace("=",""),j=!0),b=parseFloat(b)),k=g.css(a),l=isNaN(k)?0:k,m=j?b:b-l,n=c,o=this.easing[d],p=m>0?"ceil":"floor",q="__myFocusTimer__"+a,r=g[i?"setOpacity":"setAnimateStyle"],s=1*new Date,h[q]&&clearInterval(h[q]),h[q]=setInterval(function(){var b=new Date-s;n>=b?r.call(g,o(b,l,m,n),a,p):(r.call(g,l+m,a,p),clearInterval(h[q]),h[q]=null,f&&f.call(h))},13),this},fadeIn:function(a,b,c){return"number"!=typeof a&&(c=a,a=400),"function"==typeof b&&(c=b,b=""),this.animate("opacity",1,a,b||"linear",function(){myFocus(this).css({display:"block",opacity:0})},c),this},fadeOut:function(a,b,c){return"number"!=typeof a&&(c=a,a=400),"function"==typeof b&&(c=b,b=""),this.animate("opacity",0,a,b||"linear",null,function(){this.style.display="none",c&&c.call(this)}),this},slide:function(a,b,c,d){"number"!=typeof b&&(d=b,b=800),"function"==typeof c&&(d=c,c="");for(var e in a)this.animate(e,a[e],b,c||"easeOut",null,d);return this},stop:function(){var b,a=this[0];for(b in a)-1!==b.indexOf("__myFocusTimer__")&&a[b]&&clearInterval(a[b]);return this},easing:{linear:function(a,b,c,d){return c*a/d+b},swing:function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b},easeIn:function(a,b,c,d){return c*(a/=d)*a*a*a+b},easeOut:function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},easeInOut:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b}}}),myFocus.fn.extend({bind:function(a,b){return myFocus.addEvent(this[0],a,b),this},play:function(a,b,c){var d=this,e=d.settings,f=d.HTMLUListLength,g=1e3*e.time,c=c||!1,h=myFocus(d.HTMLUList).css("float"),i="left"===h,j=i?"left":"top",k=i?e.width:e.height,l=0,m=e.index;e.wrap?d.find(".loading").remove():d.parent().find(".loading").fadeOut(300),d.run=function(g){a&&a(l,f),m="string"==typeof g?l+parseInt(g.replace("=","")):g,-1>=m&&(m=f-1,c&&(d.HTMLUList[0].parentNode.style[j]=-f*k+"px")),m>=f&&(c||(m=0),m>=2*f&&(d.HTMLUList[0].parentNode.style[j]=-(f-1)*k+"px",m=f)),c&&l>=f&&f>m&&(m+=f),b&&b(m,f,l),d.runIndex=l=m,e.onChange&&e.onChange.call(d,m)};try{d.run(m)}catch(n){setTimeout(function(){d.run(m)},0)}e.auto&&f>1&&(d.runTimer=setInterval(function(){d.run("+=1")},g),d.bind("mouseover",function(){clearInterval(d.runTimer),d.runTimer="pause"}).bind("mouseout",function(){d.isStop||"pause"!==d.runTimer||(d.runTimer=setInterval(function(){d.run("+=1")},g))})),d.find("a").each(function(){this.onfocus=function(){this.blur()}})},bindControl:function(a,b){var j,k,c=this,d=c.settings,e=d.trigger,f=d.delay,g=b||{},h=g.thumbShowNum||d.thumbShowNum,i=function(){return this.index===c.runIndex||g.isRunning?void 0:(c.run(this.index),!1)};a.each(function(b){this.index=b;var c=this,d=myFocus(c);if("click"===e)d.bind("mouseover",function(){d.addClass("hover")}).bind("mouseout",function(){d.removeClass("hover")}).bind("click",i);else{if("mouseover"!==e)return alert('myFocus Error Setting(trigger) : "'+e+'"'),!1;d.bind("mouseover",function(){0===f?i.call(c):a.mouseoverTimer=setTimeout(function(){i.call(c)},f),console.log(a.mouseoverTimer)}).bind("mouseout",function(){a.mouseoverTimer&&clearTimeout(a.mouseoverTimer)})}}),h&&(j=a.css("float"),k="left"===j||"right"===j,a.dir=k?"left":"top",a.n=c.HTMLUListLength,a.showNum=h,a.showStart=d.index,a.showEnd=a.showStart+h-1,a.distance=a.css(k?"width":"height"),a.slideBody=a.parent())},scrollTo:function(a,b){var c=this.n,d=this.dir,e=this.slideBody,f={};return a>=this.showEnd?(this.showEnd=c-1>a?a+1:a,this.showStart=this.showEnd-this.showNum+1):a<=this.showStart&&(this.showStart=a>0?a-1:0,this.showEnd=this.showStart+this.showNum-1),f[d]=-this.showStart*this.distance,e.slide(f,b||500,"easeOut"),this}}),myFocus.extend({set:function(a,b){var c=this,d=a.id,e=c.initBaseCSS(d);a.pattern=a.pattern||c.defConfig.pattern,a.__clsName=a.pattern+"_"+d,c.addEvent(window,"load",function(){c.onloadWindow=!0}),c.loadPattern(a,function(){a=c.extend({},c.defConfig,c.config[a.pattern],a),c.getBoxReady(a,function(){var f=c($id(d));a.$o=f,a.xmlFile&&c.loadXML(a),a.pic=$class("pic",f[0])[0],a.width=a.width||f.css("width"),a.height=a.height||f.css("height"),c.initCSS(a,e),f.addClass(a.pattern+" "+a.__clsName),c.getIMGReady(a,function(d){a.autoZoom&&c.zoomIMG(a,d),c.pattern[a.pattern](a,c),b&&b()})})})},onloadWindow:!1,loadPattern:function(a,b){var c,d,e,f,g,h,i,j;return this.pattern[a.pattern]?(b(),void 0):(c=this.getFilePath()+"mf-pattern/"+a.pattern,d=document.createElement("script"),e=document.createElement("link"),f=c+".js",g=c+".css",d.type="text/javascript",d.src=f,e.rel="stylesheet",e.href=g,h=$tag("head")[0],i=!1,j=1e4,h.appendChild(e),h.appendChild(d),d.onload=d.onreadystatechange=function(){i||d.readyState&&"loaded"!=d.readyState&&"complete"!=d.readyState||(i=!0,b(),d.onload=d.onreadystatechange=null)},setTimeout(function(){i||($id(a.id).innerHTML="加载失败: "+f)},j),void 0)},getFilePath:function(){var c,d,e,a="",b=$tag("script");for(c=0,d=b.length;d>c;c++)if(e=b[c].src,e&&/sea([\.-].*)?\.js/i.test(e)){a=e;break}return"function"==typeof define&&define.cmd?a.slice(0,a.lastIndexOf("/")+1)+"myFocus/":a.slice(0,a.lastIndexOf("/")+1)},getBoxReady:function(a,b){var c=this;!function(){try{c.isIE?$id(a.id).doScroll():$id(a.id).innerHTML,b()}catch(d){c.onloadWindow||setTimeout(arguments.callee,0)}}()},getIMGReady:function(a,b){var j,k,c=a.loadingShow,e=($id(a.id),$tag("img",a.pic)),f=e.length,g=0,h=!1,i=new Array(f);if(!c||!f)return b(),void 0;for(j=0;f>j;j++)k=new Image,k.i=j,k.onload=function(){g+=1,i[this.i]={w:this.width,h:this.height},g!=f||h||(h=!0,b(i))},k.src=e[j].src},zoomIMG:function(a,b){var g,h,i,j,k,l,c=$tag("img",a.pic),d=c.length,e=a.width,f=a.height;for(g=0;d>g;g++)h=b[g].w,i=b[g].h,(h!=e||i!=f)&&(e>h&&f>i?(j=h,k=i,l=(f-k)/2):h/i>=e/f?(j=e,k=e/h*i,l=(f-k)/2):(j=f/i*h,k=f,l=0),c[g].style.cssText=";width:"+j+"px;height:"+k+"px;margin-top:"+l+"px;")},initCSS:function(a,b){var c=[],d=a.width||"",e=a.height||"";a.pic&&(c.push("."+a.__clsName+" *{margin:0;padding:0;border:0;list-style:none;}."+a.__clsName+"{position:relative;width:"+d+"px;height:"+e+"px;overflow:hidden;font:12px/1.5 Verdana;text-align:left;background:#fff;visibility:visible!important;}."+a.__clsName+" .pic{position:relative;width:"+d+"px;height:"+e+"px;overflow:hidden;}."+a.__clsName+" .txt li{width:"+d+"px;height:"+a.txtHeight+"px!important;overflow:hidden;}"),a.wrap&&a.$o.wrap('<div class="'+a.pattern+'_wrap"></div>'),a.autoZoom&&c.push("."+a.__clsName+" .pic li{text-align:center;width:"+d+"px;height:"+e+"px;}"));try{b.styleSheet.cssText=c.join("")}catch(f){b.innerHTML=c.join("")}},initBaseCSS:function(a){var e,b="#"+a+" *{display:none}",c=document.createElement("style");c.type="text/css";try{c.styleSheet.cssText=b}catch(d){c.innerHTML=b}return e=$tag("head",document)[0],e.insertBefore(c,e.firstChild),c}}),myFocus.extend({isIE:!(!document.all||-1!==navigator.userAgent.indexOf("Opera")),addEvent:function(a,b,c){var d=this.isIE,e=d?"attachEvent":"addEventListener",f=(d?"on":"")+b;a[e](f,function(b){var b=b||window.event,e=c.call(a,b);e===!1&&(d?(b.cancelBubble=!0,b.returnValue=!1):(b.stopPropagation(),b.preventDefault()))},!1)},loadXML:function(a){var b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLDOM");b.open("GET",a.xmlFile+"?"+Math.random(),!1),b.send(null),this.appendXML(b.responseXML,a)},appendXML:function(a,b){var f,c=a.documentElement.getElementsByTagName("item"),d=c.length,e=['<div class="loading"></div><div class="pic"><ul>'];for(f=0;d>f;f++)e.push('<li><a href="'+c[f].getAttribute("href")+'"><img src="'+c[f].getAttribute("image")+'" thumb="'+c[f].getAttribute("thumb")+'" alt="'+c[f].getAttribute("title")+'" text="'+c[f].getAttribute("text")+'" /></a></li>');e.push("</ul></div>"),b.$o[0].innerHTML=e.join("")}}),"undefined"!=typeof jQuery&&jQuery.fn.extend({myFocus:function(a,b){return this[0]?(a||(a={}),a.id=this[0].id,a.id||(a.id=this[0].id="mF__ID__"),myFocus.set(a,b),void 0):!1}}),"function"==typeof define&&define.cmd&&define(function(){return myFocus});